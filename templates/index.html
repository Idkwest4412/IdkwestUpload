<!DOCTYPE html>
<html>
<head>
    <title>File Gallery</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Useless Cloud!</h1>

    {% if logged_in %}
        <p>Welcome, {{ session.username }}! <a href="{{ url_for('logout') }}">Logout</a> | <a href="{{ url_for('upload') }}">Upload a new file</a></p>
    {% else %}
        <p><a href="{{ url_for('login') }}">Login</a> or <a href="{{ url_for('register') }}">Register</a> to upload/download files.</p>
    {% endif %}

    <ul>
        {% for file in files %}
        <li>
            <strong>{{ file['title'] }}</strong> â€” {{ file['description'] }}<br>
            Uploaded by: {{ file['uploader'] or "Unknown" }}<br>
            {% if logged_in %}
                <a href="{{ file['download_url'] }}" target="_blank">Download</a><br>
                Rating: {{ file['rating'] }}
                <form action="{{ url_for('rate', file_id=file['id']) }}" method="post" style="display:inline;">
                    <button type="submit">Rate +1</button>
                </form>
            {% else %}
                <em>Login to download and rate files.</em>
            {% endif %}
        </li>
        {% endfor %}
    </ul>

</body>
</html>
